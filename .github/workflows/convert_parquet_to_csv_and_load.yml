- name: Parquet → CSV → Load Azure SQL
  env:
    STORAGE_ACCOUNT_URL: ${{ secrets.STORAGE_ACCOUNT_URL }}
    STORAGE_CONTAINER: ${{ secrets.STORAGE_CONTAINER }}
    STORAGE_ACCOUNT_KEY: ${{ secrets.STORAGE_ACCOUNT_KEY }}

    SQL_SERVER: ${{ secrets.SQL_SERVER }}
    SQL_DATABASE: ${{ secrets.SQL_DATABASE }}
    SQL_USERNAME: ${{ secrets.SQL_USERNAME }}
    SQL_PASSWORD: ${{ secrets.SQL_PASSWORD }}

    # FIRST TEST RANGE (recommended)
    START_YEAR: "2022"
    START_MONTH: "10"
    END_YEAR: "2025"
    END_MONTH: "10"

    # delete existing CSV blobs?
    DELETE_EXISTING_CSV: "no"
  run: |
    python scripts/parquet_to_csv_and_load_sql.py
